

create table ellise.prospecting_responders_FY14
(iContactID int,
dtdate date,
mAmount money,
sKeyCode varchar(10),
maildate date,
mailtype varchar(10))
segmented by hash (iContactID) all nodes;

###### VF Responder records for DM modeling
#Feb Mailing -2/5/2014
insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '2/5/2014' as maildate, 'VF' as mailtype
from ngpdnc.contrib
where iDeleted=0 and sKeycode in (
'XXE28JA',
'XXE28JB',
'XXE28JC',
'XXE28JD',
'XXE28JE',
'XXE28JF',
'XXE28JG',
'XXE28JH',
'XXE28JJ',
'XXE28JK',
'XXE28JL',
'XXE28JM',
'XXE28JN',
'XXE27ZA',
'XXE27ZB',
'XXE27ZC',
'XXE27ZD',
'XXE27ZE',
'XXE27ZF',
'XXE27ZG',
'XXE27ZH',
'XXE27ZJ',
'XXE27ZK',
'XXE27ZL',
'XXE27ZM',
'XXE27ZN',
'XXE28HA',
'XXE28HB',
'XXE28HC',
'XXE28HD',
'XXE28HE',
'XXE28HF',
'XXE28HG',
'XXE28HH',
'XXE28HJ',
'XXE28HK',
'XXE28HL',
'XXE28HM',
'XXE28HN',
'XXE28GA',
'XXE28GB',
'XXE28GC',
'XXE28GD',
'XXE28GE',
'XXE28GF',
'XXE28GG',
'XXE28GH',
'XXE28GJ',
'XXE28GK',
'XXE28GL',
'XXE28GM',
'XXE28GN',
'XXE28FA',
'XXE28FB',
'XXE28FC',
'XXE28FD',
'XXE28FE',
'XXE28FF',
'XXE28FG',
'XXE28FH',
'XXE28FJ',
'XXE28FK',
'XXE28FL',
'XXE28FM',
'XXE28FN',
'XXE28CA',
'XXE28CB',
'XXE28CC',
'XXE28CD',
'XXE28CE',
'XXE28CF',
'XXE28CG',
'XXE28CH',
'XXE28CJ',
'XXE28CK',
'XXE28CL',
'XXE28CM',
'XXE28CN',
'XXE28BA',
'XXE28BB',
'XXE28BC',
'XXE28BD',
'XXE28BE',
'XXE28BF',
'XXE28BG',
'XXE28BH',
'XXE28BJ',
'XXE28BK',
'XXE28BL',
'XXE28BM',
'XXE28BN',
'XXE28AA',
'XXE28AB',
'XXE28AC',
'XXE28AD',
'XXE28AE',
'XXE28AF',
'XXE28AG',
'XXE28AH',
'XXE28AJ',
'XXE28AK',
'XXE28AL',
'XXE28AM',
'XXE28AN',
'XXE28EA',
'XXE28EB',
'XXE28EC',
'XXE28ED',
'XXE28EE',
'XXE28EF',
'XXE28EG',
'XXE28EH',
'XXE28EJ',
'XXE28EK',
'XXE28EL',
'XXE28EM',
'XXE28EN',
'XXE28DA',
'XXE28DB',
'XXE28DC',
'XXE28DD',
'XXE28DE',
'XXE28DF',
'XXE28DG',
'XXE28DH',
'XXE28DJ',
'XXE28DK',
'XXE28DL',
'XXE28DM',
'XXE28DN',
'XXE29GA',
'XXE29GB',
'XXE29GC',
'XXE29GD',
'XXE29GE',
'XXE29GF',
'XXE29GG',
'XXE29GH',
'XXE29GJ',
'XXE29GK',
'XXE29GL',
'XXE29GM',
'XXE29GN',
'XXE2ZAA',
'XXE2ZAB',
'XXE2ZAC',
'XXE2ZAD',
'XXE2ZAE',
'XXE2ZAF',
'XXE2ZAG',
'XXE2ZAH',
'XXE2ZAJ',
'XXE2ZAK',
'XXE2ZAL',
'XXE2ZAM',
'XXE2ZAN',
'XXE2Z1A',
'XXE2Z1B',
'XXE2Z1C',
'XXE2Z1D',
'XXE2Z1E',
'XXE2Z1F',
'XXE2Z1G',
'XXE2Z1H',
'XXE2Z1J',
'XXE2Z1K',
'XXE2Z1L',
'XXE2Z1M',
'XXE2Z1N',
'XXE2Z9A',
'XXE2Z9B',
'XXE2Z9C',
'XXE2Z9D',
'XXE2Z9E',
'XXE2Z9F',
'XXE2Z9G',
'XXE2Z9H',
'XXE2Z9J',
'XXE2Z9K',
'XXE2Z9L',
'XXE2Z9M',
'XXE2Z9N',
'XXE2Z8A',
'XXE2Z8B',
'XXE2Z8C',
'XXE2Z8D',
'XXE2Z8E',
'XXE2Z8F',
'XXE2Z8G',
'XXE2Z8H',
'XXE2Z8J',
'XXE2Z8K',
'XXE2Z8L',
'XXE2Z8M',
'XXE2Z8N',
'XXE2Z7A',
'XXE2Z7B',
'XXE2Z7C',
'XXE2Z7D',
'XXE2Z7E',
'XXE2Z7F',
'XXE2Z7G',
'XXE2Z7H',
'XXE2Z7J',
'XXE2Z7K',
'XXE2Z7L',
'XXE2Z7M',
'XXE2Z7N',
'XXE2Z6A',
'XXE2Z6B',
'XXE2Z6C',
'XXE2Z6D',
'XXE2Z6E',
'XXE2Z6F',
'XXE2Z6G',
'XXE2Z6H',
'XXE2Z6J',
'XXE2Z6K',
'XXE2Z6L',
'XXE2Z6M',
'XXE2Z6N',
'XXE2Z5A',
'XXE2Z5B',
'XXE2Z5C',
'XXE2Z5D',
'XXE2Z5E',
'XXE2Z5F',
'XXE2Z5G',
'XXE2Z5H',
'XXE2Z5J',
'XXE2Z5K',
'XXE2Z5L',
'XXE2Z5M',
'XXE2Z5N',
'XXE2Z4A',
'XXE2Z4B',
'XXE2Z4C',
'XXE2Z4D',
'XXE2Z4E',
'XXE2Z4F',
'XXE2Z4G',
'XXE2Z4H',
'XXE2Z4J',
'XXE2Z4K',
'XXE2Z4L',
'XXE2Z4M',
'XXE2Z4N',
'XXE2Z3A',
'XXE2Z3B',
'XXE2Z3C',
'XXE2Z3D',
'XXE2Z3E',
'XXE2Z3F',
'XXE2Z3G',
'XXE2Z3H',
'XXE2Z3J',
'XXE2Z3K',
'XXE2Z3L',
'XXE2Z3M',
'XXE2Z3N',
'XXE2Z2A',
'XXE2Z2B',
'XXE2Z2C',
'XXE2Z2D',
'XXE2Z2E',
'XXE2Z2F',
'XXE2Z2G',
'XXE2Z2H',
'XXE2Z2J',
'XXE2Z2K',
'XXE2Z2L',
'XXE2Z2M',
'XXE2Z2N',
'XXE29FA',
'XXE29FB',
'XXE29FC',
'XXE29FD',
'XXE29FE',
'XXE29FF',
'XXE29FG',
'XXE29FH',
'XXE29FJ',
'XXE29FK',
'XXE29FL',
'XXE29FM',
'XXE29FN'
)
;


#April Mailing - 4/8/2014
insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '4/8/2014' as maildate, 'VF' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode in (
'XXEE8JA',
'XXEE8JB',
'XXEE8JC',
'XXEE8JD',
'XXEE8JE',
'XXEE7ZA',
'XXEE7ZB',
'XXEE7ZC',
'XXEE7ZD',
'XXEE7ZE',
'XXEE8HA',
'XXEE8HB',
'XXEE8HC',
'XXEE8HD',
'XXEE8HE',
'XXEE8GA',
'XXEE8GB',
'XXEE8GC',
'XXEE8GD',
'XXEE8GE',
'XXEE8FA',
'XXEE8FB',
'XXEE8FC',
'XXEE8FD',
'XXEE8FE',
'XXEE8CA',
'XXEE8CB',
'XXEE8CC',
'XXEE8CD',
'XXEE8CE',
'XXEE8BA',
'XXEE8BB',
'XXEE8BC',
'XXEE8BD',
'XXEE8BE',
'XXEE8AA',
'XXEE8AB',
'XXEE8AC',
'XXEE8AD',
'XXEE8AE',
'XXEE8EA',
'XXEE8EB',
'XXEE8EC',
'XXEE8ED',
'XXEE8EE',
'XXEE8DA',
'XXEE8DB',
'XXEE8DC',
'XXEE8DD',
'XXEE8DE',
'XXEEZ1A',
'XXEEZ1B',
'XXEEZ1C',
'XXEEZ1D',
'XXEEZ1E',
'XXEEZ3A',
'XXEEZ3B',
'XXEEZ3C',
'XXEEZ3D',
'XXEEZ3E',
'XXEEZ2A',
'XXEEZ2B',
'XXEEZ2C',
'XXEEZ2D',
'XXEEZ2E',
'XXEE3CA',
'XXEE3CB',
'XXEE3CC',
'XXEE3CD',
'XXEE3CE',
'XXEE3DA',
'XXEE3DB',
'XXEE3DC',
'XXEE3DD',
'XXEE3DE',
'XXEE9GA',
'XXEE9GB',
'XXEE9GC',
'XXEE9GD',
'XXEE9GE'
)
;


#May Mailing - 5/27/2014
insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '5/27/2014' as maildate, 'VF' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode in (
'XXEJ8AA',
'XXEJ8AB',
'XXEJ7ZA',
'XXEJ7ZB'
);

#Late June -- 7/7/2014
insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '7/7/2014' as maildate, 'VF' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode in (
'XXEQNRA',
'XXEQNRB',
'XXEQNRC',
'XXEQNRD',
'XXEQNRE',
'XXEQNRF',
'XXEQNRG',
'XXEQNRH',
'XXEQNRJ',
'XXEQNRK',
'XXEQNQA',
'XXEQNQB',
'XXEQNQC',
'XXEQNQD',
'XXEQNQE',
'XXEQNQF',
'XXEQNQG',
'XXEQNQH',
'XXEQNQJ',
'XXEQNQK',
'XXEQNPA',
'XXEQNPB',
'XXEQNPC',
'XXEQNPD',
'XXEQNPE',
'XXEQNPF',
'XXEQNPG',
'XXEQNPH',
'XXEQNPJ',
'XXEQNPK',
'XXEQNNA',
'XXEQNNB',
'XXEQNNC',
'XXEQNND',
'XXEQNNE',
'XXEQNNF',
'XXEQNNG',
'XXEQNNH',
'XXEQNNJ',
'XXEQNNK',
'XXEQNMA',
'XXEQNMB',
'XXEQNMC',
'XXEQNMD',
'XXEQNME',
'XXEQNMF',
'XXEQNMG',
'XXEQNMH',
'XXEQNMJ',
'XXEQNMK',
'XXEQNKA',
'XXEQNKB',
'XXEQNKC',
'XXEQNKD',
'XXEQNKE',
'XXEQNKF',
'XXEQNKG',
'XXEQNKH',
'XXEQNKJ',
'XXEQNKK',
'XXEQNJA',
'XXEQNJB',
'XXEQNJC',
'XXEQNJD',
'XXEQNJE',
'XXEQNJF',
'XXEQNJG',
'XXEQNJH',
'XXEQNJJ',
'XXEQNJK',
'XXEQNHA',
'XXEQNHB',
'XXEQNHC',
'XXEQNHD',
'XXEQNHE',
'XXEQNHF',
'XXEQNHG',
'XXEQNHH',
'XXEQNHJ',
'XXEQNHK',
'XXEQNSA',
'XXEQNSB',
'XXEQNSC',
'XXEQNSD',
'XXEQNSE',
'XXEQNSF',
'XXEQNSG',
'XXEQNSH',
'XXEQNSJ',
'XXEQNSK',
'XXEQNTA',
'XXEQNTB',
'XXEQNTC',
'XXEQNTD',
'XXEQNTE',
'XXEQNTF',
'XXEQNTG',
'XXEQNTH',
'XXEQNTJ',
'XXEQNTK'
);

#July Mailing --7/28/2014

insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '7/28/2014' as maildate, 'VF' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode in (
'XXEUNRA',
'XXEUNRB',
'XXEUNRC',
'XXEUNRD',
'XXEUNRE',
'XXEUNRF',
'XXEUNRG',
'XXEUNQA',
'XXEUNQB',
'XXEUNQC',
'XXEUNQD',
'XXEUNQE',
'XXEUNQF',
'XXEUNQG',
'XXEUNPA',
'XXEUNPB',
'XXEUNPC',
'XXEUNPD',
'XXEUNPE',
'XXEUNPF',
'XXEUNPG',
'XXEUNNA',
'XXEUNNB',
'XXEUNNC',
'XXEUNND',
'XXEUNNE',
'XXEUNNF',
'XXEUNNG',
'XXEUNMA',
'XXEUNMB',
'XXEUNMC',
'XXEUNMD',
'XXEUNME',
'XXEUNMF',
'XXEUNMG',
'XXEUNKA',
'XXEUNKB',
'XXEUNKC',
'XXEUNKD',
'XXEUNKE',
'XXEUNKF',
'XXEUNKG',
'XXEUNJA',
'XXEUNJB',
'XXEUNJC',
'XXEUNJD',
'XXEUNJE',
'XXEUNJF',
'XXEUNJG',
'XXEUNHA',
'XXEUNHB',
'XXEUNHC',
'XXEUNHD',
'XXEUNHE',
'XXEUNHF',
'XXEUNHG',
'XXEUNSA',
'XXEUNSB',
'XXEUNSC',
'XXEUNSD',
'XXEUNSE',
'XXEUNSF',
'XXEUNSG',
'XXEUNTA',
'XXEUNTB',
'XXEUNTC',
'XXEUNTD',
'XXEUNTE',
'XXEUNTF',
'XXEUNTG'
);
#August Mailing - 8/20/2014	

insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '8/20/2014' as maildate, 'VF' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode in
'XXEX7ZA',
'XXEX7ZB',
'XXEX7ZC',
'XXEX8CA',
'XXEX8BA',
'XXEX8AA',
'XXEX8AB',
'XXEX8AC')
;

#September Mailing -- 9/12/14

insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '9/12/2014' as maildate, 'VF' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode='XXF4NHA';

###### Lapsed Responder records for DM modeling

#Feb mailing - 2/5/2014
insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '2/5/2014' as maildate, 'Lapsed' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode in (
'RXE1YEA',
'RXE1YEB',
'RXE1YEC',
'RXE1YED',
'RXE1YFA',
'RXE1YFB',
'RXE1YFC',
'RXE1YFD',
'RXE1YGA',
'RXE1YGB',
'RXE1YGC',
'RXE1YGD',
'RXE17EA',
'RXE17EB',
'RXE17EC',
'RXE17ED',
'RXE17FA',
'RXE17FB',
'RXE17FC',
'RXE17FD',
'RXE17GA',
'RXE17GB',
'RXE17GC',
'RXE17GD',
'XXE6T5A',
'XXE6T5B',
'XXE6T5C',
'XXE6T5D',
'XXE6T5E',
'XXE6T6A',
'XXE6T6B',
'XXE6T6C',
'XXE6T6D',
'XXE6T6E',
'XXE6T7A',
'XXE6T7B',
'XXE6T7C',
'XXE6T7D',
'XXE6T7E',
'XXE6T8A',
'XXE6T8B',
'XXE6T8C',
'XXE6T8D',
'XXE6T8E',
'XXE6XCA',
'XXE6XCB',
'XXE6XCC',
'XXE6XCD',
'XXE6XCE',
'XXE37HA',
'XXE37HB',
'XXE37HC',
'A6AME74',
'A6AME75',
'A6AME76',
'A6ADE74',
'A6ADE75',
'A6ADE76',
'A6A7E74',
'A6A7E75',
'A6A7E76',
'A6A1E74',
'A6A1E75',
'A6A1E76',
'A6AKE74',
'A6AKE75',
'A6AKE76',
'A6AHE74',
'A6AHE75',
'A6AHE76',
'A6ABE74',
'A6ABE75',
'A6ABE76',
'A6A5E74',
'A6A5E75',
'A6A5E76',
'A6AFE74',
'A6AFE75',
'A6AFE76',
'A6A9E74',
'A6A9E75',
'A6A9E76',
'A6A3E74',
'A6A3E75',
'A6A3E76',
'A6CME74',
'A6CME75',
'A6CME76',
'A6CDE74',
'A6CDE75',
'A6CDE76',
'A6C7E74',
'A6C7E75',
'A6C7E76',
'A6C1E74',
'A6C1E75',
'A6C1E76',
'A6CKE74',
'A6CKE75',
'A6CKE76',
'A6CHE74',
'A6CHE75',
'A6CHE76',
'A6CBE74',
'A6CBE75',
'A6CBE76',
'A6C5E74',
'A6C5E75',
'A6C5E76',
'A6CFE74',
'A6CFE75',
'A6CFE76',
'A6C9E74',
'A6C9E75',
'A6C9E76',
'A6C3E74',
'A6C3E75',
'A6C3E76',
'A6BME74',
'A6BME75',
'A6BME76',
'A6BDE74',
'A6BDE75',
'A6BDE76',
'A6B7E74',
'A6B7E75',
'A6B7E76',
'A6BKE74',
'A6BKE75',
'A6BKE76',
'A6BHE74',
'A6BHE75',
'A6BHE76',
'A6BBE74',
'A6BBE75',
'A6BBE76',
'A6B5E74',
'A6B5E75',
'A6B5E76',
'A6BFE74',
'A6BFE75',
'A6BFE76',
'A6B9E74',
'A6B9E75',
'A6B9E76'
);

#March Mailing - 3/28/2014
insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '3/28/2014' as maildate, 'Lapsed' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode in(
'RXE3YEA',
'RXE3YFA',
'RXE3YGA',
'RXE37EA',
'RXE37FA',
'RXE37GA',
'XXEBT5B',
'XXEBT5C',
'XXEBT6B',
'XXEBT6C',
'XXEBT7B',
'XXEBT7C',
'XXEBT8B',
'XXEBT8C',
'XXEBXCB',
'XXEBXCC',
'RXE32DA',
'RXE32CA',
'RXE32BA',
'RXE32AA',
'RXE32KA',
'RXE32JA',
'RXE32HA',
'RXE32GA',
'RXE32FA',
'RXE32EA',
'RXE32SA',
'RXE32ZA',
'RXE32YA',
'RXE32XA',
'RXE32WA',
'RXE32VA',
'RXE32UA',
'RXE32TA',
'RXE32RA',
'RXE33AA',
'RXE33BA'
);

#April Mailing -- 4/28/2014

insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '4/28/2014' as maildate, 'Lapsed' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode in(
'RXE4T5D',
'RXE4T6D',
'RXE4T7D',
'RXE4T8D',
'RXE4T9D',
'RXE4XCD',
'RXE4UDA',
'RXE4UDB',
'RXE4UDC',
'RXE4UAA',
'RXE4UAB',
'RXE4UAC',
'RXE4UEA',
'RXE4UEB',
'RXE4UEC',
'RXE4UFA',
'RXE4UFB',
'RXE4UFC',
'RXE4UGA',
'RXE4UGB',
'RXE4UGC',
'RXE4UBA',
'RXE4UBB',
'RXE4UBC',
'RXE4UCA',
'RXE4UCB',
'RXE4UCC',
'RXE4UHA',
'RXE4UHB',
'RXE4UHC'
);


#Early June Mailing - 6/6/2014

insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '6/6/2014' as maildate, 'Lapsed' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode in(
'RXE5YEA',
'RXE5YEB',
'RXE5YFA',
'RXE5YFB',
'RXE5YGA',
'RXE5YGB',
'RXE57EA',
'RXE57EB',
'XXELT5A',
'XXELT6A',
'XXELT7A',
'XXELT8A',
'XXELT9A',
'XXELTLA',
'XXELXCA'
)
;

#Late June Mailing - 6/27/2014
insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '6/27/2014' as maildate, 'Lapsed' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode in(
'RXE63BA',
'RXE62FA',
'RXE62EA',
'RXE62GA',
'RXE6L4B',
'RXE6L5C'
);
#July Mailing - 7/17/2014

insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '7/17/2014' as maildate, 'Lapsed' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode in(
'RXE72HA',
'RXE72HB',
'RXE72HC',
'RXE72GA',
'RXE72GB',
'RXE72GC',
'RXE72FA',
'RXE72FB',
'RXE72FC',
'RXE72EA',
'RXE72EB',
'RXE72EC',
'RXE73FA',
'RXE73FB',
'RXE73FC',
'RXE73EA',
'RXE73EB',
'RXE73EC'
);
#August Mailing - 8/15/2014

insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '8/15/2014' as maildate, 'Lapsed' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode in(
'XXEZT5A',
'XXEZT6A',
'XXEZT7A',
'XXEZT8A',
'XXEZT9A',
'XXEZXCA',
'XXEZXDA',
'XXEY3BA',
'XXEY3BB',
'XXEY3BC',
'XXEY3BD',
'XXEY2GA',
'XXEY2GB',
'XXEY2GC',
'XXEY2GD',
'XXEYL4A',
'XXEYL4B',
'XXEYL4C',
'XXEYL4D',
'XXEY3UA',
'XXEY3UB',
'XXEY3UC',
'XXEY3UD',
'XXEY3EA',
'XXEY3EB',
'XXEY3EC',
'XXEY3ED',
'XXEY2HA',
'XXEY2HB',
'XXEY2HC',
'XXEY2HD',
'XXEY2EA',
'XXEY2EB',
'XXEY2EC',
'XXEY2ED',
'XXEY3FA',
'XXEY3FB',
'XXEY3FC',
'XXEY3FD',
'XXEY2FA',
'XXEY2FB',
'XXEY2FC',
'XXEY2FD'
);


#September Mailing - 9/12/2014

insert into ellise.prospecting_responders_FY14
(iContactID, dtdate, mAmount, sKeyCode, maildate, mailtype)
select iContactID, dtdate, mAmount, sKeyCode, '9/12/2014' as maildate, 'Lapsed' as mailtype
from ngpdnc.contrib 
where iDeleted=0 and sKeycode in(
'XXF5T5A',
'XXF5T6A',
'XXF5T7A',
'XXF5T8A',
'XXF5T9A',
'XXF62HA',
'XXF62GA',
'XXF62FA',
'XXF62EA',
'XXF63FA',
'XXF63EA',
'R4CFECE',
'R3BBECE',
'R3BDECE',
'R3BFECE',
'R3BHECE',
'XXF64JA',
'R3BKECE',
'XXF64HA',
'XXF64GA',
'XXF64FA',
'XXF64EA',
'R3CMECE',
'R3CKECE',
'R3CHECE',
'XXF63BA',
'XXF6YGA',
'XXF6YFA',
'XXF6YEA',
'R4CBECE',
'R4CDECE',
'R4BBECE',
'R4BDECE',
'R4BFECE',
'R4BHECE',
'R3CBECE',
'R3CDECE',
'R3CFECE',
'R4CHECE'
);

create table ellise.personid_icontact_matching as (
select p.personid, m.iContactID
from analytics.person p 
left join ngpdnc.main m on
    lower(m.sFirstname)=lower(p.first_name)
AND lower(m.sLastname)=lower(p.last_name)
and p.zipcode=substring(sZip,1,5)
where m.iDeleted=0
and p.is_deceased=0)
;

create table ellise.prospect_responders_withpersonid_FY14 as 
(select p.personid, a.* 
from ellise.prospecting_responders_FY14 a
left join ellise.personid_icontact_matching p on p.iContactID=a.iContactID
);


create table finance_mktg.prospect_responders_FY14 as
(select * from ellise.prospect_responders_withpersonid_FY14);
